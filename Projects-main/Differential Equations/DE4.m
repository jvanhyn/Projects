%% 4.1 ////////////////////////////////////////////////////////////////////
clear 
clc
A = [1.2,2.5;4,0.7]
[eigenvec, eigenval] = eig(A)
%% 4.2 ////////////////////////////////////////////////////////////////////
clear 
clc

A = [3, 4; -1, -2]
[eigvec, eigval] = eig(A)
g = @(t,Y) [A(1,1)*Y(1) + A(1,2)*Y(2); A(2,1)*Y(1) + A(2,2)*Y(2)];

% C1 e2t [0.9701; -0.2425] + C2 e-t [-0.7071; 0.7071]
% As t gets very large, the solution to the differential equation tends to
% negative infinity.

P = [-10,30; -20,0; -13,20; -20,-30; -1,30; 0,-30; 1,40; 25,-30; 4,-20; 4,0; 4,20];
phaseplane(g, [-50.5,50.5], [-50.5,50.5], 16)
hold on
for i=1:size(P,1)
    drawphase(g, 50, P(i,1), P(i,2))
end
hold off

%% 4.3
clear 
clc
A = [2.7,-1;4.1,3.7]
[eigvec, eigval] = eig(A)

% y(t) = C1 e(3.2+1.9621i)t [-0.1093 + 0.4291i; 0.8966 + 0.0000i] + C2 e(3.2000 - 1.9621i)t [-0.1093 - 0.4291i; 0.8966 + 0.0000i]

g = @(t,Y) [A(1,1)*Y(1) + A(1,2)*Y(2); A(2,1)*Y(1) + A(2,2)*Y(2)];
P = [-0.1,-1.5;-1,2;-1.7,0;1,1;-1,-1;1.1,-1];
phaseplane(g, [-100,100],[-100,100],15)
hold on
for i=1:size(P,1)
    drawphase(g,1.1,P(i,1),P(i,2))
end
hold off

%% 4.4
clear 
clc

A = [1.25, -0.97, 4.6; -2.6, -5.2, -0.31; 1.18, -10.3, 1.12]
[eigvec, eigval] = eig(A)

g = @(t,Y) [A(1,1)*Y(1) + A(1,2)*Y(2); A(2,1)*Y(1) + A(2,2)*Y(2);A(3,1)*Y(1) + A(3,2)*Y(2)];

%% 4.5 
clear
clc

A = [-0.0558 -0.9968 0.0802 0.0415;0.598 -0.115 -0.0318 0;-3.05 0.388 -0.465 0;0 0.0805 1 0]
[eigvec, eigval] = eig(A)

B = [0.01; -0.175; 0.153; 0]

